#remotes::install_github("walkerke/tidycensus")
library(tidyverse)
library(tidycensus)
#a = get_decennial(geography = "state", variables = "P1_001N", year = 2020)
# head(a, 5)
#install.packages("formattable")
library(formattable)
library(htmlwidgets)
library(leaflet)
library(sf)
library(formattable)
library(dplyr)
library(tidyr)
library(janitor)
library(leaflet.extras)
census_api_key("9cabe8a191a1f824755d4a1845f13cb08faa2c5f", install = TRUE, overwrite = TRUE)
#Calls variables for the 2020 decennial census
v20_dec <- load_variables(2020, "pl", cache = TRUE)
#Calls variables for the 2020 ACS census
v20_acs <- load_variables(2020, "acs5", cache = TRUE)
#2020 Per Capita By Census Tract ACS
#2016-2020
#B19001 COUNTS THE NUMBER OF HOUSEHOLDS
#B19301_001 is the per capita income "Per capita income in the past 12 months (in 2020 inflation-adjusted dollars"
#Documentation: https://censusreporter.org/tables/B19301/
percap_income2020 <- get_acs(geography = "tract",
variables = c(number_households = "B19001_001", percap_income = "B19301_001"),
state = "MD",
year = 2020) %>%
mutate(year=("2020"))
percap_income2020
#2016 & 2010 Per Capita Income By Census Tract ACS
percap_income2016 <- get_acs(geography = "tract",
variables = c(number_households = "B19001_001", percap_income = "B19301_001"),
state = "MD",
year = 2016) %>%
mutate(year=("2016"))
#2010 Per Capita Income By Census Tract 2010
percap_income2010 <- get_acs(geography = "tract",
variables = c(number_households = "B19001_001", percap_income = "B19301_001"),
state = "MD",
year = 2010) %>%
mutate(year=("2010"))
#Bind together 2010, 2016, 2020 files
percap_md_all <- rbind(percap_income2010, percap_income2016, percap_income2020)
percap_md_all <- separate(data = percap_md_all, col = NAME, into = c("Census_Tract", "County", "State"), sep = ",", extra = "merge", fill = "right")
#write.csv(md_income_all, "md_income_all.csv")
#Subset Baltimore city-county, city files
balt_income_all <- filter(percap_md_all, grepl ("Baltimore", County))
#write.csv(balt_income_all, "balt_income_all.csv")
#Baltimore city median income, 2010, 2016, 2020
baltcity_percap_income <- filter(balt_income_all, grepl ("Baltimore city", County)) %>%
filter(variable=="percap_income")
View(percap_md_all)
#reshape percap_md_all table
percap_md_all <- percap_md_all %>%
select(-moe) %>%
pivot_wider(names_from = "year", values_from = "estimate")
percap_md_all <- janitor::clean_names(percap_md_all)
percap_md_all <- percap_md_all %>%
mutate(diff_2020_2010 = (x2020-x2010)) %>%
mutate(diff_2020_2016 = (x2020-x2016))
#write.csv(baltcity_percap_income, "baltcity_percap_income.csv")
# write_rds(baltcity_income, "baltcity_income.rds")
percap2_income2020 <- get_acs(geography = "place",
variables = c(number_households = "B19001_001", percap_income = "B19301_001"),
state = "MD",
year = 2020) %>%
mutate(year=("2020"))
percap_income2020
View(percap2_income2020)
percap2_income2010 <- get_acs(geography = "place",
variables = c(number_households = "B19001_001", percap_income = "B19301_001"),
state = "MD",
year = 2010) %>%
mutate(year=("2010"))
percap2_income <- rbind(percap2_income2020, percap2_income2010)
percap2_income <-  percap2_income %>%
select(-moe) %>%
pivot_wider(names_from = "year", values_from = "estimate")
percap2_income <- janitor::clean_names( percap2_income)
percap2_income <-  percap2_income %>%
mutate(diff_2020_2010 = (x2020-x2010)) %>%
mutate(diff_2020_2016 = (x2020-x2016))
percap2_income <-  percap2_income %>%
mutate(diff_2020_2010 = (x2020-x2010))
names(percap2_income)
percap2_income %>%
filter(variable=="percap_income") %>%
summarize(mean(estimate))
percap2_income %>%
filter(variable=="percap_income")
percap2_income %>%
filter(variable=="percap_income") %>%
summarize(mean(x2020))
percap2_income %>%
filter(variable=="percap_income") %>%
summarize(mean(x2020, rm.na=TRUE))
percap2_income %>%
filter(variable=="percap_income") %>%
summarize(mean(x2020, na.rm=TRUE))
percap2_income2020 <- get_acs(geography = "place",
variables = c(number_households = "B19001_001", percap_income = "B19301_001"),
state = "MD",
year = 2020) %>%
mutate(year=("2020"))
percap2_income2010 <- get_acs(geography = "place",
variables = c(number_households = "B19001_001", percap_income = "B19301_001"),
state = "MD",
year = 2010) %>%
mutate(year=("2010"))
percap2_income <- rbind(percap2_income2020, percap2_income2010)
#reshape percap_md_all table
percap2_income <-  percap2_income %>%
select(-moe) %>%
pivot_wider(names_from = "year", values_from = "estimate")
percap2_income <- janitor::clean_names( percap2_income)
percap2_income <-  percap2_income %>%
mutate(diff_2020_2010 = (x2020-x2010))
#write.csv(baltcity_percap_income, "baltcity_percap_income.csv")
# write_rds(baltcity_income, "baltcity_income.rds")
View(percap2_income)
